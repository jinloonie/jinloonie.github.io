<html>
<head>
    <meta charset="UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
    <style>
        body {
            background: url(quizbg.jpg);
            background-size: cover;
            background-attachment: fixed;
            background-repeat: no-repeat;
            background-position: center;
            justify-content: center;
            align-items: center;
            margin: 0px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 0 30px;
            position: relative;
            z-index: 5;
        }

        .clown-gif {
            top: -35px;
            right: -15px;
            position: fixed;
        }

       .dialoguebox {
    position: fixed;
    left: 10px;
    right: 10px;
    bottom: 70px;
    width: 80%;
    height: 400px;
    background-color: rgba(200, 200, 200, 0.8);
    border: 3px solid darkred;
    border-radius: 12px;
    color: white;
    font-family: "Creepster", system-ui;
    display: flex;
    flex-direction: column;
    justify-content: flex-start; /* Changed this */
    padding: 10px 30px;
    box-sizing: border-box;
    max-width: 1000px;
    margin: 0 auto;
}

.dialoguebox .title {
    font-size: 35px;
    text-align:center;
    margin: 10px 0 0px 0;
    padding: 0;
    line-height: 1.2;
    color: crimson;
    text-shadow: 1px 1px 2px black; /* Add depth */
}

.body-text {
    font-size: 25px;
    text-align:left;
    margin: 0;
    padding: 0;
    line-height: 1.4;
    color: #f1f1f1; /* Softer white */
}

#nextLink {
  padding: 10px 20px;
  font-size: 18px;
  font-family: "Creepster", system-ui;
  background-color: darkred;
  color: white;
  border: 2px solid white;
  border-radius: 8px;
  cursor: pointer;
  margin-top: 20px;
  align-self: center;
  transition: background-color 0.3s ease;
}

#nextLink:hover {
  background-color: crimson;
}
    </style>
</head>
<body>
    <div class="container">
        <div class="clown-gif"><img src="clownpixel.gif"></div>
        <div class="dialoguebox">
            <div id="title" class="title"></div>
            <div id="body" class="body-text" style="flex: 1 1 auto;"></div>
            <button id="nextLink" style="display:none;" onclick="location.href='page14.html'">Continue</button>
        </div>
    </div>

    <script>
        const dialogues = [
            {
                title: "ðŸŽª The Final Step",
                body: [
                    "Wait... I think you need to show your knowledge to leave this carnival?! Are you ready?"
                ]
            }
        ];

        let currentDialogue = 0;
        let bodyLine = 0;

        const titleTarget = document.getElementById("title");
        const bodyTarget = document.getElementById("body");
        const nextLink = document.getElementById("nextLink");

        function typeText(target, text, i = 0, callback) {
            if (i < text.length) {
                target.innerHTML += text.charAt(i);
                setTimeout(() => typeText(target, text, i + 1, callback), 70);
            } else {
                callback && callback();
            }
        }

        function typeDialogue() {
            titleTarget.innerHTML = "";
            bodyTarget.innerHTML = "";
            bodyLine = 0;

            typeText(titleTarget, dialogues[currentDialogue].title, 0, () => {
                typeBodyLines();
            });
        }

        function typeBodyLines() {
            if (bodyLine < dialogues[currentDialogue].body.length) {
                const line = dialogues[currentDialogue].body[bodyLine];
                const p = document.createElement("p");
                bodyTarget.appendChild(p);

                typeText(p, line, 0, () => {
                    bodyLine++;
                    setTimeout(typeBodyLines, 200); // QUICKER move to next sentence
                });
            } else {
                // IMMEDIATE move to next dialogue
                setTimeout(nextDialogue, 200); // QUICK transition to next dialogue
            }
        }

        function nextDialogue() {
            currentDialogue++;
            if (currentDialogue < dialogues.length) {
                typeDialogue();
            } else {
                nextLink.style.display = "inline";
            }
        }

        const bgMusic = new Audio("knowledgebgm.mp3");
    bgMusic.loop = true;
    bgMusic.currentTime = 2; 
    bgMusic.play().catch(e => console.log("Autoplay blocked:", e));
    
        window.onload = typeDialogue;
    </script>
</body>
</html>
